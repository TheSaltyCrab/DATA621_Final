---
title: "FInal assignment group 4"
author: Deepika Dilip, Tora Mullings, Daniel Sullivan, Deepa Sharma, Bikram Barua,
  Newman Okereafor
date: "2022-11-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, warning = F, message = F)
```

```{r}
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(corrplot)
library(reshape2)
library(knitr)
library(broom)
library(caret)
library(leaps)
library(MASS)
library(magrittr)
library(betareg)
library(pscl)
library(gtsummary)
library(nnet)
library(readr)
library(fastDummies)
```


## Abstract:

Use 250 words or less to summarize your problem, methodology, and major outcomes.

# Key words:

maternal health, clinical outcomes

# Introduction:

Describe the background and motivation of your problem.

# Literature review:

Discuss how other researchers have addressed similar problems, what their achievements are, and what the advantage and drawbacks of each    reviewed
 
approach are. Explain how your investigation is similar or different to the state-of-the- art. Please cite the relevant papers where appropriate.

# Methodology:

Discuss the key aspects of your problem, data set and regression model(s). Given that you are working on real-world data, explain at a high-level your exploratory data analysis, how you prepared the data for regression modeling, your process for building regression models, and your model selection.

```{r}
MHRD<-read.csv("https://raw.githubusercontent.com/TheSaltyCrab/DATA621_Final/main/Maternal%20Health%20Risk%20Data%20Set.csv")
```


```{r}
head(MHRD,5) %>% kable() %>% kableExtra::kable_styling()
```

### Data Attributes

* `Age`: Any ages in years when a women during pregnant.

* `SystolicBP`: Upper value of Blood Pressure in mmHg, another significant attribute during pregnancy.

* `DiastolicBP`: Lower value of Blood Pressure in mmHg, another significant attribute during pregnancy.

* `BS`: Blood glucose levels is in terms of a molar concentration, mmol/L.

* `HeartRate`: A normal resting heart rate in beats per minute.

* `Risk Level`: Predicted Risk Intensity Level during pregnancy considering the previous attribute.

```{r}
MHRD<-MHRD%>% mutate(Risk_num = case_when(
    str_detect(.$RiskLevel, "low risk") ~ "0",
    str_detect(.$RiskLevel, "mid risk") ~ "1",
    str_detect(.$RiskLevel, "high risk") ~ "2",
    TRUE ~ as.character(.$RiskLevel)))
```

We can start by making a correlation plot to compare continuous values. 
```{r}
corrplot(cor( select_if(MHRD, is.numeric), use = "complete.obs"), tl.col="black", tl.cex=0.6, order='AOE')
```

```{r}
lst.histogram = list()
for (i in names(MHRD)[1:6]) {
  MHRD.sub = MHRD %>% select(i, "RiskLevel")
  colnames(MHRD.sub) = c("value", "RiskLevel")
  lst.histogram[[i]] = ggplot(aes(value, fill = RiskLevel), data = MHRD.sub) + geom_histogram() + labs(x = i, y = "Count") + scale_fill_manual(values = c("low risk" = "navyblue", "mid risk" = "grey", "high risk" = "red"))
}
ggpubr::ggarrange(plotlist = lst.histogram, ncol = 2, nrow = 3)
```

```{r}
ggplot(aes(RiskLevel, fill = RiskLevel), data = MHRD) + geom_bar(stat = "count") + labs(x = "Risk Level", y = "Count") + scale_fill_manual(values = c("low risk" = "navyblue", "mid risk" = "grey", "high risk" = "red")) + labs(title = "Risk Level Counts")
```


# Experimentation and Results:

Describe the specifics of what you did (data exploration, data preparation, model building, model selection, model evaluation, etc.), and what you found out (statistical analyses, interpretation and discussion of the results, etc.).

# Discussion and Conclusions:

Conclude your findings, limitations, and suggest areas for future work.

# References: 

Be sure to cite all references used in the report (APA format).

#   Appendices:
#	Supplemental tables and/or figures.
#	R statistical programming code.
